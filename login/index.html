<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <script>
    function handleLogin(event) {
      event.preventDefault();

      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      const hash = sha256(password); // fungsi hash manual

      const url = `https://script.google.com/macros/s/AKfycbzMFh69CH53Ue53-31Ojse7kdi8dYCxejIe3FaAs1l-K7OLj3s6Bklaj5f-VYisdXwg/exec?username=${username}&password=${hash}`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (data.status === "success") {
            alert("Login berhasil");
            window.location.href = "../dashboard.html"; // arahkan ke halaman berikutnya
          } else {
            alert("Login gagal");
          }
        })
        .catch(err => {
          alert("Error saat login");
          console.error(err);
        });
    }

    // SHA-256 hashing pakai JS murni
    async function sha256(str) {
      const encoder = new TextEncoder();
      const data = encoder.encode(str);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
  </script>
</head>
<body>
  <h2>Login</h2>
  <form onsubmit="handleLogin(event)">
    <input type="text" id="username" placeholder="Username" required><br><br>
    <input type="password" id="password" placeholder="Password" required><br><br>
    <button type="submit">Login</button>
  </form>
</body>
</html>
